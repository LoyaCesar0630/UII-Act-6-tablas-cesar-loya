{% extends 'base.html' %}

{% block content %}
<div class="card">
    <a href="{% url 'ver_pedidos' %}" class="btn" style="background: #6c757d; color: white; margin-bottom: 1rem;">← Volver a pedidos</a>
    
    <h2>Actualizar Estado del Pedido #{{ pedido.id_pedido }}</h2>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
        <div>
            <h3>Información Actual</h3>
            <p><strong>Cliente:</strong> {{ pedido.id_usuario.nombre }}</p>
            <p><strong>Fecha:</strong> {{ pedido.fecha|date:"d/m/Y H:i" }}</p>
            <p><strong>Estado actual:</strong> 
                <span style="padding: 0.25rem 0.75rem; border-radius: 15px; 
                    {% if pedido.estado_pedido == 'entregado' %}background: #55efc4; color: #000;
                    {% elif pedido.estado_pedido == 'enviado' %}background: #74b9ff; color: #fff;
                    {% elif pedido.estado_pedido == 'confirmado' %}background: #fdcb6e; color: #000;
                    {% elif pedido.estado_pedido == 'cancelado' %}background: #ff7675; color: #fff;
                    {% else %}background: #dfe6e9; color: #000;{% endif %}">
                    {{ pedido.get_estado_pedido_display }}
                </span>
            </p>
            <p><strong>Total:</strong> ${{ pedido.total_pedido }}</p>
        </div>
        
        <div>
            <form method="post">
                {% csrf_token %}
                
                <div class="form-group">
                    <label class="form-label">Nuevo Estado del Pedido</label>
                    <select name="estado_pedido" class="form-control" required>
                        {% for estado_id, estado_nombre in pedido.ESTADO_CHOICES %}
                            <option value="{{ estado_id }}" {% if pedido.estado_pedido == estado_id %}selected{% endif %}>
                                {{ estado_nombre }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
                
                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button type="submit" class="btn btn-primary">Actualizar Estado</button>
                    <a href="{% url 'ver_pedidos' %}" class="btn" style="background: #6c757d; color: white;">Cancelar</a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}